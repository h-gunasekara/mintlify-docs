<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Catalog API Documentation</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Prism.js Theme (Tomorrow Night) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        /* Custom base styles or overrides */
        body {
            font-family: 'Inter', sans-serif; /* Consider adding a nicer font like Inter */
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        /* Tailwind overrides for specific elements */
        pre {
            background-color: #f9fafb; /* gray-50 */
            border: 1px solid #e5e7eb; /* gray-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem; /* p-4 */
            overflow-x: auto;
            margin-bottom: 1rem; /* mb-4 */
            font-size: 0.875rem; /* text-sm */
        }
        code:not(pre > code) {
            background-color: #e5e7eb; /* gray-200 */
            padding: 0.125rem 0.375rem; /* px-1.5 py-0.5 */
            border-radius: 0.25rem; /* rounded */
            font-family: monospace;
            font-size: 0.9em;
        }
        table {
            width: 100%;
            margin-bottom: 1rem; /* mb-4 */
            border-collapse: collapse;
            border: 1px solid #e5e7eb; /* gray-200 */
        }
        th, td {
            border: 1px solid #e5e7eb; /* gray-200 */
            padding: 0.75rem 1rem; /* p-3 md:p-4 */
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #f9fafb; /* gray-50 */
            font-weight: 600; /* font-semibold */
            font-size: 0.875rem; /* text-sm */
        }
        td {
             font-size: 0.875rem; /* text-sm */
        }
        /* Headings - slightly reduced top margin */
        h1, h2, h3 {
            margin-top: 1.25rem; /* mt-5 */
            margin-bottom: 0.75rem; /* mb-3 */
            font-weight: 600; /* font-semibold */
        }
        h1 { font-size: 1.875rem; line-height: 2.25rem; } /* text-2xl */
        h2 {
             font-size: 1.5rem; /* text-xl */
             line-height: 2rem;
             /* Subtle left border with accent color */
             border-left: 3px solid #00B158;
             padding-left: 0.75rem; /* pl-3 */
             color: #374151; /* gray-700 */
        }
        h3 { font-size: 1.125rem; line-height: 1.75rem; color: #4b5563; /* gray-600 */} /* text-lg */
        p {
            margin-bottom: 1rem; /* mb-4 */
            line-height: 1.625; /* leading-relaxed */
            color: #4b5563; /* gray-600 */
            font-size: 0.95rem;
        }
        ul {
            list-style-type: disc;
            margin-left: 1.5rem; /* ml-6 */
            margin-bottom: 1rem; /* mb-4 */
            color: #4b5563; /* gray-600 */
            font-size: 0.95rem;
        }
        li {
            margin-bottom: 0.35rem; /* mb-1.5 */
        }
        a {
            color: #2563eb; /* blue-600 */
            text-decoration: none;
            font-weight: 500;
        }
        a:hover {
            color: #00B158; /* Accent color on hover */
            text-decoration: underline;
        }
        /* Specific tab button styling */
        .tab-button {
             padding: 0.75rem 1rem; /* p-3 md:p-4 */
             font-weight: 500; /* medium */
             text-align: center;
             cursor: pointer;
             border-bottom: 3px solid transparent; /* Default transparent bottom border */
             transition: color 0.2s ease, border-color 0.2s ease;
             color: #6b7280; /* gray-500 */
        }
        .tab-button:hover {
             color: #374151; /* gray-700 */
        }
        .tab-button.active {
            color: #00B158; /* Accent color for active tab */
            border-bottom-color: #00B158; /* Accent color border for active tab */
            font-weight: 600; /* semibold */
        }
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="bg-white text-gray-800 p-4 md:p-8 max-w-4xl mx-auto">

    <h1 class="text-3xl font-bold border-b pb-2 mb-6">
        Catalog API Documentation
    </h1>

    <section id="introduction" class="mb-8">
        <h2 class="text-2xl font-semibold">Introduction</h2>
        <p>
            This API allows you to retrieve product data from the catalog. You can perform full-text searches,
            apply various filters based on product attributes, get paginated results, and leverage smart query features like synonym expansion and implicit filter detection.
        </p>
    </section>

    <section id="endpoint" class="mb-8">
        <h2 class="text-2xl font-semibold">Endpoint</h2>
        <p>Send POST requests to the following endpoint:</p>
        <pre><code class="language-text">POST https://catalogai.vercel.app/api/products</code></pre>
    </section>

    <section id="authentication" class="mb-8">
        <h2 class="text-2xl font-semibold">Authentication</h2>
        <p>
            All requests to this endpoint must include a valid API key passed in the <code>x-api-key</code> header.
        </p>
        <pre><code class="language-javascript">headers: {
  'Content-Type': 'application/json',
  'x-api-key': 'YOUR_VALID_API_KEY'
}</code></pre>
        <p>
            If the API key is missing or invalid, the API will return a <code>401 Unauthorized</code> error.
        </p>
    </section>

    <section id="request-body" class="mb-8">
        <h2 class="text-2xl font-semibold">Request Body</h2>
        <p>The request body must be a JSON object containing the following fields:</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Optional</th>
                        <th>Default</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>query</code></td>
                        <td><code>string</code></td>
                        <td>Yes</td>
                        <td><code>null</code></td>
                        <td>An optional naturalâ€‘language search string. The API performs several steps: 1) Extracts potential implicit filters (price, color, fabric). 2) Expands the query with synonyms using the <code>|</code> (OR) operator. 3) Removes implicit filters if the corresponding term is already in the original query. 4) Passes the expanded query and refined filters to the database for Full-Text Search (FTS). See <a href="#smart-search" class="text-blue-600 hover:text-blue-800 underline">Smart Search</a>.</td>
                    </tr>
                    <tr>
                        <td><code>filters</code></td>
                        <td><code>ProductFilters</code></td>
                        <td>Yes</td>
                        <td><code>{}</code></td>
                        <td>An object containing specific criteria to filter products. Explicit filters override any implicitly derived filters from the <code>query</code>.</td>
                    </tr>
                    <tr>
                        <td><code>page</code></td>
                        <td><code>number</code></td>
                        <td>Yes</td>
                        <td><code>1</code></td>
                        <td>The page number (1-indexed) for pagination.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3 class="text-xl font-semibold mt-6"><code>ProductFilters</code> Object</h3>
        <p>The <code>filters</code> object allows for fine-grained control over the product results. All specified filters are combined using AND logic.</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Optional</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>price_min</code></td>
                        <td><code>number</code></td>
                        <td>Yes</td>
                        <td>Minimum price (inclusive).</td>
                        <td><code>10.50</code></td>
                    </tr>
                    <tr>
                        <td><code>price_max</code></td>
                        <td><code>number</code></td>
                        <td>Yes</td>
                        <td>Maximum price (inclusive).</td>
                        <td><code>99.99</code></td>
                    </tr>
                    <tr>
                        <td><code>vendor</code></td>
                        <td><code>string</code></td>
                        <td>Yes</td>
                        <td>Filter by a specific product vendor (exact match).</td>
                        <td><code>"Palace"</code></td>
                    </tr>
                    <tr>
                        <td><code>is_available</code></td>
                        <td><code>boolean</code></td>
                        <td>Yes</td>
                        <td>Filter by product availability (<code>true</code> for available, <code>false</code> for unavailable).</td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td><code>attributes</code></td>
                        <td><code>object</code></td>
                        <td>Yes</td>
                        <td>Filter by nested product attributes.</td>
                        <td>See <a href="#attribute-filters" class="text-blue-600 hover:text-blue-800 underline">Attribute Filters</a> section below.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3 id="attribute-filters" class="text-xl font-semibold mt-6">Attribute Filters (<code>filters.attributes</code>)</h3>
        <p>The <code>attributes</code> object allows filtering based on specific characteristics stored within the product's <code>attributes</code> JSONB field.</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Attribute Key</th>
                        <th>Type</th>
                        <th>Optional</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>color</code></td>
                        <td><code>string</code></td>
                        <td>Yes</td>
                        <td>Filter by a specific color (exact match).</td>
                        <td><code>"Red"</code></td>
                    </tr>
                    <tr>
                        <td><code>fabric</code></td>
                        <td><code>object</code></td>
                        <td>Yes</td>
                        <td>Filter by fabric types. Keys are fabric names, value must be <code>true</code> to include that fabric.</td>
                        <td><code>{"cotton": true, "polyester": true}</code></td>
                    </tr>
                    <tr>
                        <td><em>...others</em></td>
                        <td><em>...</em></td>
                        <td>Yes</td>
                        <td><em>Add definitions for any other attribute filter keys as they are implemented.</em></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mt-4">
            <strong>Note on <code>fabric</code> filter:</strong> This checks if the specified fabric key exists within the <code>attributes-&gt;fabric</code> object and its value is explicitly <code>true</code>.
        </p>
    </section>

    <section id="smart-search" class="mb-8">
        <h2 class="text-2xl font-semibold">Smart Search (<code>query</code>)</h2>
        <p>When the <code>query</code> field is provided, the API performs an intelligent search process before hitting the database:</p>
        <ul>
            <li><strong>1. Implicit Filter Extraction:</strong> The API first analyzes the raw <code>query</code> string to detect potential filters like price constraints (e.g., <code>"under $50"</code>), known colors (e.g., <code>"blue"</code>), and known fabrics (e.g., <code>"cotton"</code>). These are temporarily stored as "derived filters".</li>
            <li><strong>2. Query Expansion:</strong> The raw <code>query</code> is then expanded using a predefined synonym map. For example, <code>"warm pants"</code> might become <code>"warm | winter | insulated | pants | trousers | bottoms"</code>. This expanded string is prepared for the database's Full-Text Search function.</li>
    </section>

    <section id="response" class="mb-8">
        <h2 class="text-2xl font-semibold">Response</h2>

        <h3 class="text-xl font-semibold mt-4">Success (Status Code <code>200 OK</code>)</h3>
        <p>On a successful request, the API returns a JSON object with the following structure:</p>
        <pre><code class="language-json">{
  "products": [
    {
      "id": 2458,
      "title": "Oversized Logo Hoodie",
      "description": "Iconic oversized silhouette hoodie featuring our signature logo print. Crafted from premium cotton blend fleece with a soft brushed interior for ultimate comfort.",
      "vendor": "Balenciaga",
      "url": "https://www.balenciaga.com/en-us/oversized-logo-hoodie-black-600583TJVE11055.html",
      "is_available": true,
      "attributes": {
        "category": "Men > Hoodies & Sweatshirts",
        "color": "Black",
        "fabric": { "cotton": true, "polyester": true },
        "product_id": "60JVE55"
      },
      "images": [
        { "url": "https://assets.balenciaga.com/images/60JVE55.jpg", "alt": "Black oversized hoodie back" }
      ],
      "variants": [
        {
          "url": "https://www.balenciaga.com/en-us/oversized-logo-hoodie-black-60JVE55.html",
          "image": {
            "url": "https://assets.balenciaga.com/images/60JVE55.jpg"
          },
          "title": "Oversized Logo Hoodie - Black",
          "options": [
            {
              "size": "S",
              "price": {
                "value": 950,
                "currency": "USD",
                "display_value": 950
              },
              "is_in_stock": true
            },
            {
              "size": "M",
              "price": {
                "value": 950,
                "currency": "USD",
                "display_value": 950
              },
              "is_in_stock": true
            },
            {
              "size": "L",
              "price": {
                "value": 950,
                "currency": "USD",
                "display_value": 950
              },
              "is_in_stock": false
            },
          ]
        }
      ],
      "price_currency": "USD",
      "price_display": 950
    }
  ],
  "meta": {
    "totalItems": 50,
    "totalPages": 15,  // Total number of pages available (totalItems / pageSize)
    "currentPage": 1,  // The current page number (matches request 'page')
    "pageSize": 10   
  }
}</code></pre>
        <ul>
            <li><code>products</code>: An array containing the product objects matching the search and filter criteria for the requested page. This array will be empty if no products match on the current page.</li>
            <li><code>meta</code>: An object containing pagination and total count metadata.
                <ul>
                    <li class="ml-4"><code>totalPages</code>: The total number of pages calculated based on <code>totalItems</code> and <code>pageSize</code>.</li>
                    <li class="ml-4"><code>currentPage</code>: The page number returned in this response (echoes the request parameter <code>page</code>).</li>
                    <li class="ml-4"><code>pageSize</code>: The maximum number of items requested per page.</li>
                    <li class="ml-4"><code>totalItems</code>: The total count of products matching the <code>query</code> and <code>filters</code> across all available pages. <strong>Note: This value is capped at 50 regardless of the actual total.</strong></li>
                </ul>
            </li>
        </ul>
    </section>

    <section id="examples" class="mb-8">
        <h2 class="text-xl font-semibold">Examples</h2>
        <p>Replace <code>YOUR_VALID_API_KEY</code> with your actual API key.</p>

        <!-- Example Request Structure -->
        <div class="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
            <h3 class="text-base font-semibold mb-2 text-gray-700">Example Request Bodies</h3>
            <p class="text-sm text-gray-600 mb-2">These JSON bodies are used in the examples below.</p>
            <details class="mb-2">
                <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">1. Search Query (No filters, defaults)</summary>
                <pre><code class="language-json">{ "query": "organic cotton shirt" }</code></pre>
            </details>
            <details class="mb-2">
                <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">2. Filters (Vendor, Availability, Price - defaults)</summary>
                <pre><code class="language-json">{ 
  "filters": { 
    "vendor": "EcoWear", 
    "is_available": true, 
    "price_min": 20.00, 
    "price_max": 50.00 
  }
}</code></pre>
            </details>
            <details class="mb-2">
                <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">3. Filters (Attributes)</summary>
                <pre><code class="language-json">{ 
  "filters": { 
    "attributes": { 
      "color": "Green", 
      "fabric": { "linen": true } 
    } 
  }
}</code></pre>
            </details>
             <details class="mb-2">
                <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">4. Combined Search & Filters (defaults)</summary>
                <pre><code class="language-json">{ 
  "query": "jacket",
  "filters": { 
    "vendor": "TrailBlazer" 
  }
}</code></pre>
            </details>
            <details>
                <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">5. Search with Pagination (Page 2)</summary>
                <pre><code class="language-json">{ 
  "query": "shoes",
  "page": 2
}</code></pre>
            </details>
        </div>

        <!-- Language Examples -->
        <div class="border border-gray-200 rounded-lg overflow-hidden">
            <!-- Tabs (Optional JS needed for real tab functionality) -->
            <div class="flex border-b border-gray-200 bg-gray-50 overflow-x-auto no-scrollbar">
                <button class="tab-button flex-shrink-0 active" data-target="curl-examples">cURL</button>
                <button class="tab-button flex-shrink-0" data-target="js-examples">JavaScript (fetch)</button>
                <button class="tab-button flex-shrink-0" data-target="python-examples">Python (requests)</button>
            </div>

            <!-- cURL Examples -->
            <div id="curl-examples" class="tab-content p-4">
                <h3 class="text-base font-semibold mb-3 text-gray-700">cURL Examples</h3>
                <!-- Example 1 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">1. Search Query (No filters, defaults)</summary>
                    <pre class="mt-2"><code class="language-bash">
API_ENDPOINT="https://catalogai.vercel.app/api/products"
API_KEY="YOUR_VALID_API_KEY"

curl -X POST $API_ENDPOINT \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: $API_KEY" \\
  -d '{
        "query": "organic cotton shirt"
      }'
                    </code></pre>
                </details>
                <!-- Example 2 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">2. Filters (Vendor, Availability, Price - defaults)</summary>
                    <pre class="mt-2"><code class="language-bash">
API_ENDPOINT="https://catalogai.vercel.app/api/products"
API_KEY="YOUR_VALID_API_KEY"

curl -X POST $API_ENDPOINT \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: $API_KEY" \\
  -d '{
        "filters": {
          "vendor": "EcoWear",
          "is_available": true,
          "price_min": 20.00,
          "price_max": 50.00
        }
      }'
                    </code></pre>
                </details>
                <!-- Example 3 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">3. Filters (Attributes)</summary>
                    <pre class="mt-2"><code class="language-bash">
API_ENDPOINT="https://catalogai.vercel.app/api/products"
API_KEY="YOUR_VALID_API_KEY"

curl -X POST $API_ENDPOINT \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: $API_KEY" \\
  -d '{
        "filters": {
          "attributes": {
            "color": "Green",
            "fabric": {
              "linen": true
            }
          }
        }
      }'
                    </code></pre>
                </details>
                <!-- Example 4 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">4. Combined Search & Filters (defaults)</summary>
                    <pre class="mt-2"><code class="language-bash">
API_ENDPOINT="https://catalogai.vercel.app/api/products"
API_KEY="YOUR_VALID_API_KEY"

curl -X POST $API_ENDPOINT \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: $API_KEY" \\
  -d '{
        "query": "jacket",
        "filters": {
          "vendor": "TrailBlazer"
        }
      }'
                    </code></pre>
                </details>
                <!-- Example 5 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">5. Search with Pagination (Page 2)</summary>
                    <pre class="mt-2"><code class="language-bash">
API_ENDPOINT="https://catalogai.vercel.app/api/products"
API_KEY="YOUR_VALID_API_KEY"

curl -X POST $API_ENDPOINT \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: $API_KEY" \\
  -d '{
        "query": "shoes",
        "page": 2
      }'
                    </code></pre>
                </details>
            </div>

            <!-- JavaScript Examples -->
            <div id="js-examples" class="tab-content p-4 hidden">
                <h3 class="text-base font-semibold mb-3 text-gray-700">JavaScript (fetch) Examples</h3>
                <p class="text-sm text-gray-600 mb-3">Defines a function to call the API and then shows usage examples.</p>
                <pre class="mb-4"><code class="language-javascript">// Define API endpoint and key
const API_ENDPOINT = "https://catalogai.vercel.app/api/products";
const API_KEY = "YOUR_VALID_API_KEY"; // Replace with your actual key

// Reusable function to fetch products
const fetchProducts = async (body) => {
  try {
    const response = await fetch(API_ENDPOINT, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': API_KEY
      },
      body: JSON.stringify(body)
    });

    const responseData = await response.json(); // Try to parse JSON regardless of status

    if (!response.ok) {
      // Use error message from API if available, otherwise status text
      const errorMessage = responseData.error || response.statusText;
      throw new Error(`API Error (${response.status}): ${errorMessage}`);
    }

    console.log("API Call Successful:", body);
    console.log("Response Metadata:", responseData.meta);
    // You can process responseData.products here
    return responseData; // Return the full data on success

  } catch (error) {
    console.error("API Call Failed:", body, "\\nError:", error);
    // Rethrow or handle the error appropriately in your application
    throw error; // Rethrow the error to be caught by the caller
  }
};

// Example usage (wrap calls in async IIFE or use in an async context)
(async () => {
  try {
    // Example 1: Call the function
    // const results1 = await fetchProducts({ query: "organic cotton shirt" });
    // console.log("Example 1 Results:", results1.products.length, "products found.");

    // Example 2: Call the function
    // const results2 = await fetchProducts({ filters: { vendor: "EcoWear", is_available: true, price_min: 20.00, price_max: 50.00 } });
    // console.log("Example 2 Results:", results2.products.length, "products found.");

    // ... add calls for other examples as needed ...

  } catch (err) {
    console.error("An error occurred during one of the API calls:", err);
  }
})();</code></pre>
                <!-- Example 1 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">1. Search Query (No filters, defaults)</summary>
                    <pre class="mt-2"><code class="language-javascript">
// Example 1: Search for "organic cotton shirt"
// Assumes fetchProducts function is defined as above
(async () => {
  try {
    const data = await fetchProducts({ query: "organic cotton shirt" });
    console.log(data); // Process the response data
  } catch (error) {
    // Handle error
  }
})();
                    </code></pre>
                </details>
                <!-- Example 2 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">2. Filters (Vendor, Availability, Price - defaults)</summary>
                     <pre class="mt-2"><code class="language-javascript">
// Example 2: Filter by vendor, availability, price
// Assumes fetchProducts function is defined as above
(async () => {
  try {
    const data = await fetchProducts({
      filters: {
        vendor: "EcoWear",
        is_available: true,
        price_min: 20.00,
        price_max: 50.00
      }
    });
    console.log(data); // Process the response data
  } catch (error) {
    // Handle error
  }
})();
                    </code></pre>
                </details>
                 <!-- Example 3 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">3. Filters (Attributes)</summary>
                     <pre class="mt-2"><code class="language-javascript">
// Example 3: Filter by attributes (color, fabric)
// Assumes fetchProducts function is defined as above
(async () => {
  try {
    const data = await fetchProducts({
      filters: {
        attributes: {
          color: "Green",
          fabric: { linen: true }
        }
      }
    });
    console.log(data); // Process the response data
  } catch (error) {
    // Handle error
  }
})();
                    </code></pre>
                </details>
                <!-- Example 4 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">4. Combined Search & Filters (defaults)</summary>
                     <pre class="mt-2"><code class="language-javascript">
// Example 4: Combine search and filter
// Assumes fetchProducts function is defined as above
(async () => {
  try {
    const data = await fetchProducts({
      query: "jacket",
      filters: { vendor: "TrailBlazer" }
    });
    console.log(data); // Process the response data
  } catch (error) {
    // Handle error
  }
})();
                    </code></pre>
                </details>
                <!-- Example 5 -->
                <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">5. Search with Pagination (Page 2)</summary>
                     <pre class="mt-2"><code class="language-javascript">
// Example 5: Search with Pagination (Page 2)
// Assumes fetchProducts function is defined as above
(async () => {
  try {
    const data = await fetchProducts({
      query: "shoes",
      page: 2
    });
    console.log(data); // Process the response data
  } catch (error) {
    // Handle error
  }
})();
                    </code></pre>
                </details>
            </div>

            <!-- Python Examples -->
            <div id="python-examples" class="tab-content p-4 hidden">
                <h3 class="text-base font-semibold mb-3 text-gray-700">Python (requests) Examples</h3>
                 <p class="text-sm text-gray-600 mb-3">Requires the <code>requests</code> library (<code>pip install requests</code>). Defines a function to call the API and then shows usage examples.</p>
                 <pre class="mb-4"><code class="language-python">import requests
import json
import os # Optional: for getting API key from environment variable

# Define API endpoint and key
API_ENDPOINT = "https://catalogai.vercel.app/api/products"
# Recommended: Get API key from environment variable for security
API_KEY = os.getenv("CATALOG_API_KEY", "YOUR_VALID_API_KEY") 

def fetch_products(body):
    """Sends a POST request to the product catalog API."""
    headers = {
        'Content-Type': 'application/json',
        'x-api-key': API_KEY
    }
    try:
        response = requests.post(API_ENDPOINT, headers=headers, json=body)
        # Raise an exception for bad status codes (4xx or 5xx)
        response.raise_for_status() 
        # Return the parsed JSON response on success
        return response.json() 
    except requests.exceptions.RequestException as e:
        # Handle connection errors, timeouts, etc.
        print(f"Request failed: {e}") 
        # Try to print error details from response if possible
        if e.response is not None:
            try:
                 print(f"Error response: {e.response.json()}")
            except json.JSONDecodeError:
                 print(f"Error response (non-JSON): {e.response.text}")
        # Re-raise the exception or handle it as needed
        raise 
    except json.JSONDecodeError:
        # Handle cases where the response is not valid JSON
        print("Failed to decode JSON response.")
        print(f"Raw response text: {response.text}")
        raise # Re-raise or handle

# Example usage:
# try:
#    # Example 1 call
#    # data1 = fetch_products({"query": "organic cotton shirt"})
#    # print("Example 1:", json.dumps(data1['meta'], indent=2))
#    
#    # Example 2 call
#    # data2 = fetch_products({"filters": {"vendor": "EcoWear", "is_available": True, "price_min": 20.00, "price_max": 50.00}})
#    # print("Example 2:", json.dumps(data2['meta'], indent=2))
#    
#    # ... add calls for other examples ...
#
# except requests.exceptions.RequestException as e:
#    print(f"An error occurred during API call: {e}")
# except Exception as e:
#    print(f"An unexpected error occurred: {e}")

                 </code></pre>
                 <!-- Example 1 -->
                 <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">1. Search Query (No filters, defaults)</summary>
                     <pre class="mt-2"><code class="language-python">
# Example 1: Search for "organic cotton shirt"
# Assumes fetch_products function is defined as above
try:
    data = fetch_products({"query": "organic cotton shirt"})
    print(json.dumps(data['meta'], indent=2)) # Process response data
except Exception as e:
    print(f"Error: {e}")

                     </code></pre>
                </details>
                 <!-- Example 2 -->
                 <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">2. Filters (Vendor, Availability, Price - defaults)</summary>
                     <pre class="mt-2"><code class="language-python">
# Example 2: Filter by vendor, availability, price
# Assumes fetch_products function is defined as above
try:
    data = fetch_products({
        "filters": {
            "vendor": "EcoWear",
            "is_available": True, # Python boolean
            "price_min": 20.00,
            "price_max": 50.00
        }
    })
    print(json.dumps(data['meta'], indent=2)) # Process response data
except Exception as e:
    print(f"Error: {e}")

                     </code></pre>
                </details>
                 <!-- Example 3 -->
                 <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">3. Filters (Attributes)</summary>
                     <pre class="mt-2"><code class="language-python">
# Example 3: Filter by attributes (color, fabric)
# Assumes fetch_products function is defined as above
try:
    data = fetch_products({
        "filters": {
            "attributes": {
                "color": "Green",
                "fabric": {"linen": True} # Python boolean
            }
        }
    })
    print(json.dumps(data['meta'], indent=2)) # Process response data
except Exception as e:
    print(f"Error: {e}")

                     </code></pre>
                </details>
                 <!-- Example 4 -->
                 <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">4. Combined Search & Filters (defaults)</summary>
                     <pre class="mt-2"><code class="language-python">
# Example 4: Combine search and filter
# Assumes fetch_products function is defined as above
try:
    data = fetch_products({
        "query": "jacket",
        "filters": {"vendor": "TrailBlazer"}
    })
    print(json.dumps(data['meta'], indent=2)) # Process response data
except Exception as e:
    print(f"Error: {e}")

                     </code></pre>
                </details>
                 <!-- Example 5 -->
                 <details class="mb-3">
                    <summary class="cursor-pointer font-medium text-blue-600 hover:text-[#00B158]">5. Search with Pagination (Page 2)</summary>
                     <pre class="mt-2"><code class="language-python">
# Example 5: Search with Pagination (Page 2)
# Assumes fetch_products function is defined as above
try:
    data = fetch_products({
        "query": "shoes",
        "page": 2
    })
    print(json.dumps(data['meta'], indent=2)) # Process response data
except Exception as e:
    print(f"Error: {e}")

                     </code></pre>
                </details>
            </div>
        </div>

        <!-- Simple Tab Switching Logic -->
        <script>
            const tabs = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Deactivate all tabs and hide all content
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => {
                        c.classList.add('hidden');
                        c.classList.remove('block'); // Ensure block is removed
                    });

                    // Activate clicked tab and show corresponding content
                    tab.classList.add('active');
                    const targetId = tab.getAttribute('data-target');
                    const targetContent = document.getElementById(targetId);
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                        targetContent.classList.add('block'); // Ensure block is added
                    }
                });
            });

            // Initialize: Show the first tab (cURL)
            if (tabs.length > 0) {
                tabs[0].classList.add('active');
                const initialTargetId = tabs[0].getAttribute('data-target');
                const initialContent = document.getElementById(initialTargetId);
                if (initialContent) {
                    initialContent.classList.remove('hidden');
                    initialContent.classList.add('block');
                }
            }
        </script>
    </section>

    <!-- Prism.js Core -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <!-- Prism.js Languages (Load components for languages used) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body>
</html> 
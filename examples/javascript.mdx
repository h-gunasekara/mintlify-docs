---
title: 'JavaScript Examples'
description: 'Examples of using the Catalog API with JavaScript'
---

import JsWarning from '/snippets/js-warning.mdx';

<JsWarning />

# JavaScript Examples

These examples demonstrate how to use the Catalog API with JavaScript using the Fetch API.

<Note>
  Replace `YOUR_API_KEY` with your actual API key in all examples.
</Note>

## Setup

First, let's define a reusable function to call the API:

```javascript
// Define API endpoint and key
const API_ENDPOINT = "https://catalogai.vercel.app/api/products";
const API_KEY = "YOUR_API_KEY"; // Replace with your actual key

// Reusable function to fetch products
const fetchProducts = async (body) => {
  try {
    const response = await fetch(API_ENDPOINT, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': API_KEY
      },
      body: JSON.stringify(body)
    });

    const responseData = await response.json(); // Try to parse JSON regardless of status

    if (!response.ok) {
      // Use error message from API if available, otherwise status text
      const errorMessage = responseData.error || response.statusText;
      throw new Error(`API Error (${response.status}): ${errorMessage}`);
    }

    return responseData; // Return the full data on success

  } catch (error) {
    console.error("API Call Failed:", error);
    throw error; // Rethrow the error to be caught by the caller
  }
};
```

## Basic Search

Search for products matching "cotton shirt":

```javascript
// Example 1: Search for "cotton shirt"
(async () => {
  try {
    const data = await fetchProducts({ query: "cotton shirt" });
    console.log(`Found ${data.meta.totalItems} products`);
    console.log("First product:", data.products[0]?.title);
  } catch (error) {
    console.error("Search failed:", error);
  }
})();
```

## Using Filters

Filter products by vendor, availability, and price range:

```javascript
// Example 2: Filter by vendor, availability, price
(async () => {
  try {
    const data = await fetchProducts({
      filters: {
        vendor: "EcoWear",
        is_available: true,
        price_min: 20.00,
        price_max: 50.00
      }
    });
    console.log(`Found ${data.meta.totalItems} products`);
    console.log("Price range:", data.products.map(p => p.price_display));
  } catch (error) {
    console.error("Search failed:", error);
  }
})();
```

## Filtering by Attributes

Filter products by color and fabric:

```javascript
// Example 3: Filter by attributes (color, fabric)
(async () => {
  try {
    const data = await fetchProducts({
      filters: {
        attributes: {
          color: "Green",
          fabric: ["linen"]
        }
      }
    });
    console.log(`Found ${data.meta.totalItems} green linen products`);
  } catch (error) {
    console.error("Search failed:", error);
  }
})();
```

## Combined Search and Filters

Search for "jacket" and filter by vendor:

```javascript
// Example 4: Combine search and filter
(async () => {
  try {
    const data = await fetchProducts({
      query: "jacket",
      filters: { vendor: "TrailBlazer" }
    });
    console.log(`Found ${data.meta.totalItems} TrailBlazer jackets`);
  } catch (error) {
    console.error("Search failed:", error);
  }
})();
```

## Pagination

Get the second page of search results for "shoes":

```javascript
// Example 5: Search with pagination (page 2)
(async () => {
  try {
    const data = await fetchProducts({
      query: "shoes",
      page: 2
    });
    console.log(`Page ${data.meta.currentPage} of ${data.meta.totalPages}`);
    console.log(`Showing products ${(data.meta.currentPage-1)*data.meta.pageSize+1}-${Math.min(data.meta.currentPage*data.meta.pageSize, data.meta.totalItems)} of ${data.meta.totalItems}`);
  } catch (error) {
    console.error("Search failed:", error);
  }
})();
```

## React Example

Here's how you might use the API in a React component:

```jsx
import { useState, useEffect } from 'react';

const API_ENDPOINT = "https://catalogai.vercel.app/api/products";
const API_KEY = "YOUR_API_KEY"; // Replace with your actual key

const ProductSearch = () => {
  const [searchTerm, setSearchTerm] = useState('');
  const [products, setProducts] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);
  const [page, setPage] = useState(1);
  const [pagination, setPagination] = useState({});

  const searchProducts = async () => {
    if (!searchTerm.trim()) return;
    
    setIsLoading(true);
    setError(null);
    
    try {
      const response = await fetch(API_ENDPOINT, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': API_KEY
        },
        body: JSON.stringify({
          query: searchTerm,
          page: page
        })
      });
      
      const data = await response.json();
      
      if (!response.ok) {
        throw new Error(data.error || 'Failed to fetch products');
      }
      
      setProducts(data.products);
      setPagination(data.meta);
    } catch (err) {
      setError(err.message);
      setProducts([]);
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    if (searchTerm) {
      searchProducts();
    }
  }, [page]); // Re-fetch when page changes

  const handleSearch = (e) => {
    e.preventDefault();
    setPage(1); // Reset to first page on new search
    searchProducts();
  };

  const handlePrevPage = () => {
    if (page > 1) setPage(page - 1);
  };

  const handleNextPage = () => {
    if (page < pagination.totalPages) setPage(page + 1);
  };

  return (
    <div className="product-search">
      <form onSubmit={handleSearch}>
        <input
          type="text"
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          placeholder="Search products..."
        />
        <button type="submit" disabled={isLoading}>
          {isLoading ? 'Searching...' : 'Search'}
        </button>
      </form>
      
      {error && <div className="error">{error}</div>}
      
      {products.length > 0 ? (
        <>
          <div className="product-list">
            {products.map(product => (
              <div key={product.id} className="product-card">
                <h3>{product.title}</h3>
                <p>{product.description}</p>
                <div className="price">${product.price_display}</div>
              </div>
            ))}
          </div>
          
          {pagination.totalPages > 1 && (
            <div className="pagination">
              <button 
                onClick={handlePrevPage} 
                disabled={page === 1 || isLoading}
              >
                Previous
              </button>
              <span>Page {page} of {pagination.totalPages}</span>
              <button 
                onClick={handleNextPage} 
                disabled={page === pagination.totalPages || isLoading}
              >
                Next
              </button>
            </div>
          )}
        </>
      ) : (
        !isLoading && searchTerm && <div>No products found</div>
      )}
    </div>
  );
};

export default ProductSearch;
```

## Error Handling

Here's a more robust error handling example:

```javascript
const searchProducts = async (query, filters = {}, page = 1) => {
  try {
    const response = await fetch(API_ENDPOINT, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': API_KEY
      },
      body: JSON.stringify({ query, filters, page })
    });
    
    // Always try to parse the JSON response first
    let data;
    try {
      data = await response.json();
    } catch (jsonError) {
      throw new Error(`Failed to parse API response: ${jsonError.message}`);
    }
    
    // Then check the response status
    if (!response.ok) {
      // Handle different error types
      if (response.status === 401) {
        throw new Error(`Authentication error: ${data.error || 'Invalid API key'}`);
      } else if (response.status === 400) {
        throw new Error(`Invalid request: ${data.error || 'Bad request'}`);
      } else {
        throw new Error(`API error (${response.status}): ${data.error || response.statusText}`);
      }
    }
    
    return data;
  } catch (error) {
    // Catch network errors or other exceptions
    if (error.name === 'AbortError') {
      console.log('Request was cancelled');
    } else if (error.name === 'TypeError' && error.message.includes('NetworkError')) {
      console.error('Network error - check your internet connection');
    } else {
      console.error(`Error fetching products: ${error.message}`);
    }
    throw error;
  }
};
``` 